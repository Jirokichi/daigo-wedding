<!doctype html5>
<html lang="ja" ng-app>
<head>
    <meta charset="utf-8">
    <title>タッチアプリ</title>
    <script lang="JavaScript1.2"> 
      var speed= 100; // この値（ミリ秒）毎に画面が変わる
      var tt=  800;
      var pxa= 800; // 鶴のX方向位置(Pixel)
      var pya= 100; // 鶴のY方向位置(Pixel)
      var stp=   5; // 鶴の1回移動量(Pixel)
      function move(t, id) 
      {
        pxa = t;  //  下に移動させる場合には　pya を変更する
        document.getElementById(id).style.left = pxa;
        document.getElementById(id).style.top  = pya;
      }
          
      function disp() 
      {
        console.log("disp:" + tt);
        if(tt>=-160)
        {
          setTimeout("disp()", speed);
        }
        else
        {
          tt = 800  ; 
          setTimeout("disp()", speed);
        }
        tt=tt-stp ;
        move(tt, "edit_box00_00");
      }
      
      function createNewText(){
        console.log("createNewText");
        var element = document.createElement('div'); 
        element.id = "id";
        element.innerHTML = "hogehoge"; 
        element.style.backgroundColor = 'red'; 
        
        var objBody = document.getElementsByTagName("body").item(0); 
        objBody.appendChild(element); 
      }
      
    </script>
</head>
<body>
  <!--<div id="edit_box00_00" style="position: absolute; z-index: 2; VISIBILITY: visible; TOP: 150px; LEFT: 15px; width:1;">-->
  <!--  <input type="text" value="">-->
  <!--</div>-->
  <style>
    #edit_box00_00 {
      position: fixed;
      bottom: 0;
      width: 100%;
      height: 50px;
    }
  </style>
  <div id="edit_box00_00">
    <input type="text" value=""> 
    <button type="button" onClick="createNewText()">createNewText</button>
  </div>
  
  
  
  
  <script type="text/javascript">
  
    
    
    // 匿名関数内で実行
    (function (){
        
        var id = "edit_box00_00";
        var textBox = document.getElementById(id)
        
        console.log("start(" + textBox.offsetWidth + ", " + textBox.offsetHeight + ")");
      	// エレメントを取得
      	var element = document.getElementById(id);
    
      	// タッチイベントをサポートしているか調べる
      	var msg;
      	if(window.TouchEvent){
      	  msg = "タッチイベントに対応";
      		element.value = msg;
          console.log(msg);
              
              
          // イベントリスナーに対応している
          if(document.addEventListener){
            console.log("イベントリスナーに対応している");
          	// ------------------------------------------------------------
          	// タッチすると実行される関数
          	// ------------------------------------------------------------
          	function TouchEventFunc(e){
              	console.log("TouchEventFunc:" + e + "(" + e.clientX + ", " + e.clientY + ")");
              		  
              	// TouchList オブジェクトを取得
              	var touch_list = e.changedTouches;
              			
              	var element = document.getElementById(id);
              	element.style.left = e.changedTouches[0].pageX;
                element.style.top  = e.changedTouches[0].pageY ;
              	
          }
          
          var PC = false;
          if(PC){
            // document.addEventListener("click",TouchEventFunc);
            document.addEventListener("mousedown",TouchEventFunc);
          }else{
            var element2 = document.getElementById(id);
            // タッチを開始すると実行されるイベント
        	  element2.addEventListener("touchstart",TouchEventFunc);
        
        		// タッチしたまま平行移動すると実行されるイベント
        		element2.addEventListener("touchmove",TouchEventFunc);
        
        		// タッチを終了すると実行されるイベント
        		element2.addEventListener("touchend",TouchEventFunc);
          }
          
          
        //   var element2 = document.getElementById("edit_box00_00");
        //   // タッチを開始すると実行されるイベント
      		// element2.addEventListener("touchstart",TouchEventFunc);
      
      		// // タッチしたまま平行移動すると実行されるイベント
      		// element2.addEventListener("touchmove",TouchEventFunc);
      
      		// // タッチを終了すると実行されるイベント
      		// element2.addEventListener("touchend",TouchEventFunc);
          		
          }else{
            console.log("イベントリスナーに対応していない");
          }
      	}else{
      	  msg = "タッチイベントに未対応";
      		element.value = msg
          console.log(msg);
      	}
      	
        console.log("fin");
    })();
  </script>
</body>
</html>